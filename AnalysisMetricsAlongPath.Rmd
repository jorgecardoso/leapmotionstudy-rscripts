Title
========================================================


```{r requires}
require(psych)
require(ggplot2)
require(doBy)
require(grid)
library(doParallel)
library(reshape2)
```




```{r analysis-measures-alongpath,  fig.show='hold'}
filenameInWindowMEMOMV <- paste("data/", "measuresWindow-10-MEMOMV-feup.txt", sep="")
filenameInWindowTRETACMDCODC <- paste("data/", "measuresWindow-10-TRETACMDCODC-feup.txt", sep="")

windowMEMOMV <- read.csv(filenameInWindowMEMOMV, sep="", head = TRUE)
windowTRETACMDCODC <- read.csv(filenameInWindowTRETACMDCODC, sep="", head = TRUE)


windowMEMOMV <- windowMEMOMV[ windowMEMOMV$UserId != 5,]
windowTRETACMDCODC <- windowTRETACMDCODC[ windowTRETACMDCODC$UserId != 5,]

windowMEMOMV <- windowMEMOMV[as.numeric(windowMEMOMV$Block) > 3 & as.numeric(windowMEMOMV$Block) < 8,]
windowTRETACMDCODC <- windowTRETACMDCODC[as.numeric(windowTRETACMDCODC$Block) > 3 & as.numeric(windowTRETACMDCODC$Block) < 8,]



aggDataTRETACMDCODC<-aggregate( windowTRETACMDCODC[ , c("TREEvents","TACEvents",  "MDCEvents", "ODCEvents")], 
                     windowTRETACMDCODC[ , c("Device", "Cut")], mean)

aggDataTRETACMDCODC<-melt(aggDataTRETACMDCODC, id.vars=1:2)

describeBy(aggDataTRETACMDCODC$value, list(aggDataTRETACMDCODC$Device, aggDataTRETACMDCODC$variable))


for ( event in c("TREEvents","TACEvents",  "MDCEvents", "ODCEvents") ) {
    p <- ggplot(aggDataTRETACMDCODC[aggDataTRETACMDCODC$variable==event,], aes(x=Cut, y=value, group=Device, colour=Device, fill=Device)) + 
        #stat_summary(fun.y="mean", geom="bar") + 
        geom_bar(stat="identity") + #, width=.5, position = position_dodge(width=0.5)) +
        facet_wrap( ~ Device, nrow=3)  + 
        #geom_bar() +
        #coord_flip() +
        ylab(event) +
        xlab("Completed path (%)") +
        #theme(legend.position=c(.5,-0.1), legend.direction="horizontal", 
        #      axis.text.x = element_blank()) + 
        #scale_x_discrete(breaks=c(levels(aggData$CutsDistance)[1], 
        #                          levels(aggData$CutsDistance)[length(levels(aggData$CutsDistance))]), labels=c("100%", "0%")) +
        scale_fill_brewer(palette="Set1") + 
        scale_colour_brewer(palette="Set1") 
    
     print(p)
    
    ggsave(file = paste("charts/",filenameprefix,"-metricsalongpath-",event,".pdf", sep=""), width=30/2.54, height=16/2.54, dpi=100)
}






aggDataMOMEMV <-aggregate(windowMEMOMV[ ,c("MO", "ME", "MV")], 
                                      windowMEMOMV[ ,c("Device",  "Cut")], mean)


aggDataMOMEMV<-melt(aggDataMOMEMV, id.vars=1:2)
#reverse the cutsdistance factor so we get a plot with minimum distance on the right
##aggDataMOMEMV$Cut <- factor(aggDataMOMEMV$Cut, rev(levels(aggDataMOMEMV$Cut)))

for ( event in c("MO","ME",  "MV") ) {
    p <- ggplot(aggDataMOMEMV[aggDataMOMEMV$variable==event,], aes(x=Cut, y=value, group=Device, colour=Device, fill=Device)) + 
        #stat_summary(fun.y="mean", geom="bar") + 
        geom_bar(stat="identity") + #, width=.5, position = position_dodge(width=0.5)) +
        facet_wrap( ~ Device, nrow=3)  + 
        #geom_bar() +
        #coord_flip() +
        ylab(event) +
        xlab("Completed path (%)") +
        #theme(legend.position=c(.5,-0.1), legend.direction="horizontal", 
        #      axis.text.x = element_blank()) + 
        #scale_x_discrete(breaks=c(levels(aggDataMOMEMV$Cut)[1], 
        #                          levels(aggDataMOMEMV$Cut)[length(levels(aggDataMOMEMV$Cut))]), labels=c("100%", "0%")) +
        scale_fill_brewer(palette="Set1") + 
        scale_colour_brewer(palette="Set1") 
    
     print(p)
    
    ggsave(file = paste("charts/",filenameprefix,"-metricsalongpath-",event,".pdf", sep=""), width=30/2.54, height=16/2.54, dpi=100)
}


describeBy(aggDataMOMEMV$value, list(aggDataMOMEMV$Device, aggDataMOMEMV$variable))
```
